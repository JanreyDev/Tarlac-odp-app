{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Primex-Alec/Downloads/open-data-portal/components/map/map-component.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { useEffect, useMemo } from \"react\"\r\nimport { MapContainer, TileLayer, Marker, Popup, LayersControl, LayerGroup, GeoJSON } from \"react-leaflet\"\r\nimport L from \"leaflet\"\r\n\r\nexport type DataPoint = {\r\n  id: string | number\r\n  lat: number\r\n  lng: number\r\n  title: string\r\n  type: \"school\" | \"hospital\" | \"infrastructure\"\r\n}\r\n\r\nexport type MapComponentProps = {\r\n  data: DataPoint[]\r\n  showSchools: boolean\r\n  showHospitals: boolean\r\n  showInfrastructure: boolean\r\n  showFloodProne: boolean\r\n  showLandslide: boolean\r\n  floodGeoJson?: any\r\n  landslideGeoJson?: any\r\n}\r\n\r\n// Fix default marker icon paths (404 in Next.js without static copy)\r\nfunction ensureLeafletIcons() {\r\n  // @ts-ignore\r\n  delete L.Icon.Default.prototype._getIconUrl\r\n  L.Icon.Default.mergeOptions({\r\n    iconRetinaUrl: \"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png\",\r\n    iconUrl: \"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png\",\r\n    shadowUrl: \"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png\",\r\n  })\r\n}\r\n\r\n// Custom colored icons for types\r\nconst schoolIcon = new L.Icon({\r\n  iconUrl:\r\n    \"data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjMDA0OWZmIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNSIgaGVpZ2h0PSIzOSIgdmlld0JveD0iMCAwIDI1IDM5Ij48cGF0aCBkPSJNMTEuNSAwYy0zLjkgMCA3LjUgMTggNy41IDE4czExLjQtMTguMCA3LjUtMThDMTguOSAwIDE1LjQgMCAxMS41IDB6Ii8+PC9zdmc+\",\r\n  iconSize: [25, 39],\r\n  iconAnchor: [12, 39],\r\n  popupAnchor: [0, -32],\r\n  shadowUrl: \"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png\",\r\n  shadowSize: [41, 41],\r\n  shadowAnchor: [13, 41],\r\n})\r\n\r\nconst hospitalIcon = new L.Icon({\r\n  iconUrl:\r\n    \"data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjZWY0NDQ0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNSIgaGVpZ2h0PSIzOSIgdmlld0JveD0iMCAwIDI1IDM5Ij48cGF0aCBkPSJNMTEuNSAwYy0zLjkgMCA3LjUgMTggNy41IDE4czExLjQtMTguMCA3LjUtMThDMTguOSAwIDE1LjQgMCAxMS41IDB6Ii8+PC9zdmc+\",\r\n  iconSize: [25, 39],\r\n  iconAnchor: [12, 39],\r\n  popupAnchor: [0, -32],\r\n  shadowUrl: \"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png\",\r\n  shadowSize: [41, 41],\r\n  shadowAnchor: [13, 41],\r\n})\r\n\r\nconst infrastructureIcon = new L.Icon({\r\n  iconUrl:\r\n    \"data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjZjU5ZTBiIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNSIgaGVpZ2h0PSIzOSIgdmlld0JveD0iMCAwIDI1IDM5Ij48cGF0aCBkPSJNMTEuNSAwYy0zLjkgMCA3LjUgMTggNy41IDE4czExLjQtMTguMCA3LjUtMThDMTguOSAwIDE1LjQgMCAxMS41IDB6Ii8+PC9zdmc+\",\r\n  iconSize: [25, 39],\r\n  iconAnchor: [12, 39],\r\n  popupAnchor: [0, -32],\r\n  shadowUrl: \"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png\",\r\n  shadowSize: [41, 41],\r\n  shadowAnchor: [13, 41],\r\n})\r\n\r\nexport default function MapComponent({ data, showSchools, showHospitals, showInfrastructure, showFloodProne, showLandslide, floodGeoJson, landslideGeoJson }: MapComponentProps) {\r\n  useEffect(() => {\r\n    ensureLeafletIcons()\r\n  }, [])\r\n\r\n  const center = useMemo(() => ({ lat: 15.4801, lng: 120.5979 }), []) // Tarlac approx\r\n\r\n  const { BaseLayer, Overlay } = LayersControl\r\n\r\n  return (\r\n    <div className=\"relative h-full w-full\">\r\n      <MapContainer center={center} zoom={10} className=\"absolute inset-0 h-full w-full z-0\">\r\n        <LayersControl position=\"topright\">\r\n          <BaseLayer checked name=\"Clean Map\">\r\n            <TileLayer\r\n              attribution='&copy; OpenStreetMap contributors'\r\n              url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\r\n            />\r\n          </BaseLayer>\r\n\r\n          <BaseLayer name=\"Satellite Hybrid\">\r\n            <LayerGroup>\r\n              {/* Esri World Imagery */}\r\n              <TileLayer\r\n                attribution='Tiles &copy; Esri'\r\n                url=\"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}\"\r\n              />\r\n              {/* Stamen Toner Lines for labels/roads */}\r\n              <TileLayer\r\n                attribution='Map tiles by Stamen Design'\r\n                url=\"https://stamen-tiles.a.ssl.fastly.net/toner-lines/{z}/{x}/{y}.png\"\r\n                opacity={0.7}\r\n              />\r\n            </LayerGroup>\r\n          </BaseLayer>\r\n\r\n          {showFloodProne && floodGeoJson && (\r\n            <Overlay checked name=\"Flood Prone Areas (100yr)\">\r\n              <GeoJSON data={floodGeoJson as any} style={{ color: \"#3b82f6\", weight: 1.5, fillColor: \"#3b82f6\", fillOpacity: 0.25 }} />\r\n            </Overlay>\r\n          )}\r\n\r\n          {showLandslide && landslideGeoJson && (\r\n            <Overlay checked name=\"Landslide Susceptibility\">\r\n              <GeoJSON data={landslideGeoJson as any} style={{ color: \"#ef4444\", weight: 1.5, fillColor: \"#ef4444\", fillOpacity: 0.25 }} />\r\n            </Overlay>\r\n          )}\r\n        </LayersControl>\r\n\r\n        {(showSchools || showHospitals || showInfrastructure) &&\r\n          data.map((d) => {\r\n            if (d.type === \"school\" && !showSchools) return null\r\n            if (d.type === \"hospital\" && !showHospitals) return null\r\n            if (d.type === \"infrastructure\" && !showInfrastructure) return null\r\n            const icon = d.type === \"school\" ? schoolIcon : d.type === \"hospital\" ? hospitalIcon : infrastructureIcon\r\n            return (\r\n              <Marker key={d.id} position={{ lat: d.lat, lng: d.lng }} icon={icon}>\r\n                <Popup>\r\n                  <div className=\"text-sm\">\r\n                    <div className=\"font-medium\">{d.title}</div>\r\n                    <div className=\"text-muted-foreground capitalize\">{d.type}</div>\r\n                  </div>\r\n                </Popup>\r\n              </Marker>\r\n            )\r\n          })}\r\n      </MapContainer>\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}}]
}